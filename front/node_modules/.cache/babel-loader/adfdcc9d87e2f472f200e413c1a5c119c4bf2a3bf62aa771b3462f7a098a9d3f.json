{"ast":null,"code":"import{useState,useEffect}from'react';import{Form,Button,Container,Row,Col,Alert,Card}from'react-bootstrap';import{useNavigate,Link}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import api from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const{login}=useAuth();const navigate=useNavigate();// Modifica la funzione handleSubmit\nconst handleSubmit=async e=>{e.preventDefault();try{const response=await api.post('/auth/login/local',{email,password});const{user,token}=response.data;login(user,token);navigate('/');}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Errore durante il login');}};// Modifica la funzione useEffect per il token Google\nuseEffect(()=>{const urlParams=new URLSearchParams(window.location.search);const token=urlParams.get('token');if(token){try{api.get('/auth/me',{headers:{Authorization:`Bearer ${token}`}}).then(response=>{login(response.data.user,token);navigate('/');}).catch(error=>{setError('Errore di autenticazione con Google');});}catch(error){setError('Errore di autenticazione con Google');}}},[login,navigate]);const handleGoogleLogin=()=>{window.location.href='http://localhost:3100/auth/google';};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-md-center mt-5\",children:/*#__PURE__*/_jsx(Col,{xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{className:\"shadow-sm\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4\",children:\"Accedi\"}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",placeholder:\"Inserisci email\",value:email,onChange:e=>setEmail(e.target.value),className:\"py-2\"})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-4\",controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value),className:\"py-2\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2 mb-3\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",size:\"lg\",className:\"py-2\",children:\"Accedi\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-3\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:\"oppure\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2\",children:/*#__PURE__*/_jsxs(Button,{variant:\"outline-secondary\",onClick:handleGoogleLogin,className:\"d-flex align-items-center justify-content-center py-2\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",fill:\"currentColor\",className:\"bi bi-google me-2\",viewBox:\"0 0 16 16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z\"})}),\"Accedi con Google\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"Non hai un account? \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Registrati\"})]})})]})]})})})})});};export default Login;","map":{"version":3,"names":["useState","useEffect","Form","Button","Container","Row","Col","Alert","Card","useNavigate","Link","useAuth","api","jsx","_jsx","jsxs","_jsxs","Login","email","setEmail","password","setPassword","error","setError","login","navigate","handleSubmit","e","preventDefault","response","post","user","token","data","err","_err$response","_err$response$data","message","urlParams","URLSearchParams","window","location","search","get","headers","Authorization","then","catch","handleGoogleLogin","href","children","className","xs","md","Body","variant","onSubmit","Group","controlId","Label","Control","type","placeholder","value","onChange","target","size","onClick","xmlns","width","height","fill","viewBox","d","to"],"sources":["/Users/giuliacolli/Desktop/progetto back/front/src/pages/Login.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Form, Button, Container, Row, Col, Alert, Card } from 'react-bootstrap';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport api from '../utils/api';\r\n\r\nconst Login = () => {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState('');\r\n    const { login } = useAuth();\r\n    const navigate = useNavigate();\r\n    \r\n    // Modifica la funzione handleSubmit\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const response = await api.post('/auth/login/local', { email, password });\r\n            const { user, token } = response.data;\r\n            login(user, token);\r\n            navigate('/');\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || 'Errore durante il login');\r\n        }\r\n    }\r\n    \r\n    // Modifica la funzione useEffect per il token Google\r\n    useEffect(() => {\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        const token = urlParams.get('token');\r\n        \r\n        if (token) {\r\n            try {\r\n                api.get('/auth/me', {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                }).then(response => {\r\n                    login(response.data.user, token);\r\n                    navigate('/');\r\n                }).catch(error => {\r\n                    setError('Errore di autenticazione con Google');\r\n                });\r\n            } catch (error) {\r\n                setError('Errore di autenticazione con Google');\r\n            }\r\n        }\r\n    }, [login, navigate]);\r\n    const handleGoogleLogin = () => {\r\n        window.location.href = 'http://localhost:3100/auth/google';\r\n    }\r\n    \r\n    return (\r\n        <Container>\r\n            <Row className=\"justify-content-md-center mt-5\">\r\n                <Col xs={12} md={6}>\r\n                    <Card className=\"shadow-sm\">\r\n                        <Card.Body className=\"p-4\">\r\n                            <h2 className=\"text-center mb-4\">Accedi</h2>\r\n                            {error && <Alert variant=\"danger\">{error}</Alert>}\r\n                            <Form onSubmit={handleSubmit}>\r\n                                <Form.Group className=\"mb-3\" controlId=\"email\">\r\n                                    <Form.Label>Email</Form.Label>\r\n                                    <Form.Control \r\n                                        type=\"email\" \r\n                                        placeholder=\"Inserisci email\" \r\n                                        value={email} \r\n                                        onChange={(e) => setEmail(e.target.value)} \r\n                                        className=\"py-2\"\r\n                                    />\r\n                                </Form.Group>\r\n                                <Form.Group className=\"mb-4\" controlId=\"password\">\r\n                                    <Form.Label>Password</Form.Label>\r\n                                    <Form.Control \r\n                                        type=\"password\" \r\n                                        placeholder=\"Password\" \r\n                                        value={password} \r\n                                        onChange={(e) => setPassword(e.target.value)} \r\n                                        className=\"py-2\"\r\n                                    />\r\n                                </Form.Group>\r\n                                <div className=\"d-grid gap-2 mb-3\">\r\n                                    <Button variant=\"primary\" type=\"submit\" size=\"lg\" className=\"py-2\">\r\n                                        Accedi\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"text-center mb-3\">\r\n                                    <span className=\"text-muted\">oppure</span>\r\n                                </div>\r\n                                <div className=\"d-grid gap-2\">\r\n                                    <Button \r\n                                        variant=\"outline-secondary\" \r\n                                        onClick={handleGoogleLogin} \r\n                                        className=\"d-flex align-items-center justify-content-center py-2\"\r\n                                    >\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" className=\"bi bi-google me-2\" viewBox=\"0 0 16 16\">\r\n                                            <path d=\"M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z\"/>\r\n                                        </svg>\r\n                                        Accedi con Google\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"text-center mt-4\">\r\n                                    <p className=\"mb-0\">Non hai un account? <Link to=\"/register\">Registrati</Link></p>\r\n                                </div>\r\n                            </Form>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </Container>\r\n    );\r\n}\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}