{"ast":null,"code":"import{useState,useEffect}from'react';import{Form,Button,Alert,ListGroup}from'react-bootstrap';import{useAuth}from'../contexts/AuthContext';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Comments=_ref=>{let{postId}=_ref;const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[error,setError]=useState('');const{user}=useAuth();const fetchComments=async()=>{try{const response=await axios.get(`http://localhost:3100/comments/post/${postId}`);setComments(response.data);}catch(err){setError('Errore nel caricamento dei commenti');}};useEffect(()=>{fetchComments();},[postId]);const handleSubmit=async e=>{e.preventDefault();try{const response=await axios.post('http://localhost:3100/comments',{content:newComment,author:user._id,post:postId});setComments([response.data,...comments]);setNewComment('');setError('');}catch(err){setError('Errore durante l\\'invio del commento');}};const handleDelete=async commentId=>{try{await axios.delete(`http://localhost:3100/comments/${commentId}`);setComments(comments.filter(comment=>comment._id!==commentId));}catch(err){setError('Errore durante l\\'eliminazione del commento');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-5\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Commenti\"}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),user&&/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,className:\"mb-4\",children:[/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Scrivi un commento...\",required:true})}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Pubblica commento\"})]}),/*#__PURE__*/_jsx(ListGroup,{className:\"mt-4\",children:comments.map(comment=>/*#__PURE__*/_jsxs(ListGroup.Item,{className:\"d-flex justify-content-between align-items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ms-2 me-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fw-bold\",children:[comment.author.firstName,\" \",comment.author.lastName]}),comment.content,/*#__PURE__*/_jsx(\"div\",{className:\"text-muted small\",children:new Date(comment.createdAt).toLocaleString()})]}),user&&user._id===comment.author._id&&/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",onClick:()=>handleDelete(comment._id),children:\"Elimina\"})]},comment._id))})]});};export default Comments;","map":{"version":3,"names":["useState","useEffect","Form","Button","Alert","ListGroup","useAuth","axios","jsx","_jsx","jsxs","_jsxs","Comments","_ref","postId","comments","setComments","newComment","setNewComment","error","setError","user","fetchComments","response","get","data","err","handleSubmit","e","preventDefault","post","content","author","_id","handleDelete","commentId","delete","filter","comment","className","children","variant","onSubmit","Group","Control","as","rows","value","onChange","target","placeholder","required","type","map","Item","firstName","lastName","Date","createdAt","toLocaleString","size","onClick"],"sources":["/Users/giuliacolli/Desktop/progetto back/front/src/components/Comments.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Form, Button, Alert, ListGroup } from 'react-bootstrap';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport axios from 'axios';\r\n\r\nconst Comments = ({ postId }) => {\r\n    const [comments, setComments] = useState([]);\r\n    const [newComment, setNewComment] = useState('');\r\n    const [error, setError] = useState('');\r\n    const { user } = useAuth();\r\n\r\n    const fetchComments = async () => {\r\n        try {\r\n            const response = await axios.get(`http://localhost:3100/comments/post/${postId}`);\r\n            setComments(response.data);\r\n        } catch (err) {\r\n            setError('Errore nel caricamento dei commenti');\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchComments();\r\n    }, [postId]);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const response = await axios.post('http://localhost:3100/comments', {\r\n                content: newComment,\r\n                author: user._id,\r\n                post: postId\r\n            });\r\n            setComments([response.data, ...comments]);\r\n            setNewComment('');\r\n            setError('');\r\n        } catch (err) {\r\n            setError('Errore durante l\\'invio del commento');\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (commentId) => {\r\n        try {\r\n            await axios.delete(`http://localhost:3100/comments/${commentId}`);\r\n            setComments(comments.filter(comment => comment._id !== commentId));\r\n        } catch (err) {\r\n            setError('Errore durante l\\'eliminazione del commento');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"mt-5\">\r\n            <h4>Commenti</h4>\r\n            {error && <Alert variant=\"danger\">{error}</Alert>}\r\n            \r\n            {user && (\r\n                <Form onSubmit={handleSubmit} className=\"mb-4\">\r\n                    <Form.Group className=\"mb-3\">\r\n                        <Form.Control\r\n                            as=\"textarea\"\r\n                            rows={3}\r\n                            value={newComment}\r\n                            onChange={(e) => setNewComment(e.target.value)}\r\n                            placeholder=\"Scrivi un commento...\"\r\n                            required\r\n                        />\r\n                    </Form.Group>\r\n                    <Button type=\"submit\" variant=\"primary\">\r\n                        Pubblica commento\r\n                    </Button>\r\n                </Form>\r\n            )}\r\n\r\n            <ListGroup className=\"mt-4\">\r\n                {comments.map(comment => (\r\n                    <ListGroup.Item key={comment._id} className=\"d-flex justify-content-between align-items-start\">\r\n                        <div className=\"ms-2 me-auto\">\r\n                            <div className=\"fw-bold\">\r\n                                {comment.author.firstName} {comment.author.lastName}\r\n                            </div>\r\n                            {comment.content}\r\n                            <div className=\"text-muted small\">\r\n                                {new Date(comment.createdAt).toLocaleString()}\r\n                            </div>\r\n                        </div>\r\n                        {user && user._id === comment.author._id && (\r\n                            <Button\r\n                                variant=\"outline-danger\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleDelete(comment._id)}\r\n                            >\r\n                                Elimina\r\n                            </Button>\r\n                        )}\r\n                    </ListGroup.Item>\r\n                ))}\r\n            </ListGroup>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Comments;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}